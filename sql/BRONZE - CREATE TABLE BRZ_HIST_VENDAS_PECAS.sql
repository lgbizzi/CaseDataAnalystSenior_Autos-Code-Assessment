CREATE TABLE BRZ_HIST_VENDAS_PECAS (
    ID_VENDA_PECA              NUMBER GENERATED BY DEFAULT AS IDENTITY,
    COD_CONCESSIONARIA         VARCHAR2(10)   NOT NULL,
    COD_FILIAL                 VARCHAR2(10)   NOT NULL,
    NOME_CONCESSIONARIA        VARCHAR2(100),
    NOME_FILIAL                VARCHAR2(100),
    MARCA_FILIAL               VARCHAR2(50),
    DT_VENDA                   DATE           NOT NULL,
    QTDE_VENDIDA               NUMBER(18,2),
    TIPO_TRANSACAO             VARCHAR2(50),
    VALOR_VENDA                NUMBER(18,2),
    CUSTO_PECA                 NUMBER(18,2),
    LUCRO_VENDA                NUMBER(18,2),
    MARGEM_VENDA               NUMBER(9,4),
    DESCRICAO_PECA             VARCHAR2(200),
    CATEGORIA_PECA             VARCHAR2(100),
    DEPARTAMENTO_VENDA         VARCHAR2(100),
    TIPO_VENDA_PECA            VARCHAR2(100),
    NOME_VENDEDOR              VARCHAR2(100),
    NOME_COMPRADOR             VARCHAR2(150),
    CIDADE_VENDA               VARCHAR2(100),
    ESTADO_VENDA               VARCHAR2(50),
    MACROREGIAO_VENDA          VARCHAR2(50),
    CONSTRAINT PK_BRZ_HIST_VENDAS_PECAS
        PRIMARY KEY (ID_VENDA_PECA)
);

-- FKs lógicas (mesmo que Bronze não valide fisicamente, já deixa pronto)
-- Ex.: para futura Dim_Peca (SILVER/GOLD), o join será por DESCRICAO/CATEGORIA
-- e para filial por COD_CONCESSIONARIA/COD_FILIAL. [file:2]

-- Índices (tabela de maior volume)
CREATE INDEX IX_BRZ_VP_FILIAL_DATA
    ON BRZ_HIST_VENDAS_PECAS (COD_CONCESSIONARIA, COD_FILIAL, DT_VENDA);

CREATE INDEX IX_BRZ_VP_PECA
    ON BRZ_HIST_VENDAS_PECAS (DESCRICAO_PECA, CATEGORIA_PECA);

CREATE INDEX IX_BRZ_VP_VENDEDOR
    ON BRZ_HIST_VENDAS_PECAS (NOME_VENDEDOR);

CREATE INDEX IX_BRZ_VP_CIDADE_ESTADO
    ON BRZ_HIST_VENDAS_PECAS (ESTADO_VENDA, CIDADE_VENDA);
